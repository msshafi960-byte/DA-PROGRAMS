import pandas as pd
import numpy as np

data = {
    'age': [25, 27, np.nan, np.nan, 100, 30, 27],
    'salary': ["50000", "52000", "51000", "50500", "52000", "52000", np.nan],
    "city": ['A', 'B', 'B', 'A', 'A', 'A', 'A']
}
df = pd.DataFrame(data)
print("Original data:")
print(df)

df['age'] = df['age'].fillna(df['age'].mean())
print("\nAfter handling missing values:")
print(df)

Q1 = df['age'].quantile(0.25)
Q3 = df['age'].quantile(0.75)
IQR = Q3 - Q1
lower_limit = Q1 - 1.5 * IQR
upper_limit = Q3 + 1.5 * IQR
df = df[(df['age'] >= lower_limit) & (df['age'] <= upper_limit)]
print("\nAfter noise deduction (outliers removed):")
print(df)

df = df.drop_duplicates()
print("\nAfter redundant (duplicate records) removal:")
print(df)